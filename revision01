var DT_CHEST_BATTLE = "dropTable_battleChest"; // 전투 보상 상자의 드롭테이블

handlers.unlockChest = function (args, context) {

    var request = {

        PlayFabId: currentPlayerId,

        ContainerItemInstanceId: 

    };

    var playerStatResult = server.UpdatePlayerStatistics(request);  

    

    return playerStatResult;

};


handlers.grantChest = function (args, context) {

    //Check the player's inventory to ensure that a "ReferralBadge" does not exist
    var GetUserInventoryRequest = {
            "PlayFabId": currentPlayerId
    };    

    var DTresult = server.EvaluateRandomResultTable({ TableId : DT_CHEST_BATTLE });

    var pull = server.GrantItemsToUser({ PlayFabId: currentPlayerId, ItemIds: [DTresult.ResultItemId] });

    var results = pull.ItemGrantResults;

    var instId = results.ItemInstanceId;

    

    return { "InstanceId": instId };

}

handlers.userUpdate = function (args, context) {

    server.UpdateUserInventoryItemCustomData({ 

      PlayFabId: currentPlayerId, 

      ItemInstanceId: instId 

      Data: { Time: position }

    });

}

